# Taller â€“ â€œPizza y Puntoâ€

### Contexto

La cadena de pizzerÃ­asÂ **â€œPizza y Puntoâ€**Â ha tenido un crecimiento acelerado y ahora desea llevar un mejor control sobre los pedidos, el inventario y el desempeÃ±o de sus ventas. Hasta ahora, todo lo hacÃ­an a mano: lÃ¡piz, papel y llamadas. Pero el caos reina en la cocina. Los repartidores estÃ¡n peleando por entregas duplicadas, los ingredientes se acaban sin previo aviso y no hay forma de saber cuÃ¡l pizza es la mÃ¡s popular.

Tu misiÃ³n es construir unaÂ **aplicaciÃ³n por consola en Node.js**Â que resuelva estos problemas, utilizandoÂ **MongoDB**Â como base de datos y aprovechando dos herramientas poderosas:

- **Aggregation Framework**: para obtener reportes de ventas e ingredientes.
- **Transacciones**: para garantizar que un pedido afecte mÃºltiples colecciones de forma segura.

---

## Objetivos

Desarrollar un sistema modularizado que permita:

- Registrar pedidos completos de clientes.
- Controlar el inventario de ingredientes.
- Asignar repartidores de forma automatizada.
- Analizar los datos de ventas y tendencias usando agregaciones.

Todo esto con una interfaz de lÃ­nea de comandos, utilizando Node.js,Â `inquirer`, y conexiÃ³n a MongoDB conÂ `mongodb`.

---

## Estructura de datos sugerida

DiseÃ±a tu modelo de datos como mejor se ajuste a la lÃ³gica, pero debe contemplar **al menos** las siguientes entidades:

### ğŸ§€Â `ingredientes`

- `nombre`: String
- `tipo`: String (queso, salsa, topping, etc.)
- `stock`: Number (unidades disponibles)

### ğŸ•Â `pizzas`

- `nombre`: String
- `categoria`: String (tradicional, especial, vegana, etc.)
- `precio`: Number
- `ingredientes`: [referencias o arrays de objetos]

### ğŸ“¦Â `pedidos`

- `clienteId`
- `pizzas`: lista de pizzas pedidas
- `total`: valor total
- `fecha`: timestamp
- `repartidorAsignado`: referencia

### ğŸ›µÂ `repartidores`

- `nombre`
- `zona`
- `estado`: disponible / ocupado

### ğŸ‘¤Â `clientes`

- `nombre`
- `telefono`
- `direccion`

---

## Parte 1: Transacciones

Implementa una funciÃ³nÂ `realizarPedido(clienteId, pizzaIds[])`Â que ejecute lo siguiente como unaÂ **transacciÃ³n**:

1. Verifica que todos los ingredientes requeridos estÃ©n disponibles en stock.
2. Resta del inventario la cantidad usada por las pizzas del pedido.
3. Registra el pedido completo con pizzas, cliente y total.
4. Asigna automÃ¡ticamente un repartidor disponible, y actualiza su estado aÂ **ocupado**.

Si alguna parte falla (por ejemplo, falta de ingredientes o repartidores),Â **todo el pedido debe revertirse automÃ¡ticamente**.

---

## Parte 2: Consultas con Aggregation Framework

Crea funciones en la aplicaciÃ³n que usen elÂ **Aggregation Framework**Â para resolver:

1. Â¿CuÃ¡les son losÂ **ingredientes mÃ¡s utilizados**Â en los pedidos del Ãºltimo mes?
2. Â¿CuÃ¡l es elÂ **promedio de precios por categorÃ­a de pizza**?
3. Â¿QuÃ©Â **categorÃ­a de pizzas**Â ha tenido mÃ¡s ventas histÃ³ricas?

Cada funciÃ³n debe mostrar los resultados en consola de forma clara y legible.

---

## TecnologÃ­as y herramientas requeridas

- Node.js (estructura modular)
- MongoDB (no mongoose)
- `inquirer`Â para entrada de datos
- `mongodb`Â para la conexiÃ³n y gestiÃ³n de transacciones
- `.gitignore`Â bien definido (excluyendoÂ `node_modules`, etc.)


- **.gitignore**: AsegÃºrate de excluir archivos innecesarios (`node_modules`, archivos de configuraciÃ³n locales).
- **README.md**: Incluye:
    - DescripciÃ³n del sistema.
    - Instrucciones claras para ejecutar la aplicaciÃ³n desde consola.
    - DescripciÃ³n de los comandos disponibles.
    - CÃ³mo se estructuran las transacciones.
    
    - Ejemplos de uso de las consultas con Aggregation.